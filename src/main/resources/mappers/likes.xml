<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gma.gmagame.mapper.LikesMapper">
    <insert id="plusLike" parameterType="com.gma.gmagame.model.Likes">
        insert into LIKES_BASs(BNO , USER_ID,rno)
        values(#{bno} ,#{userId},(SELECT NVL(MAX(rno), 0) + 1 FROM LIKES_BASs))
    </insert>

    <select id="getLike" resultType="Integer">
        select count(*) from LIKES_BASs where bno = #{bno}
    </select>

    <update id="updateLike" parameterType="Integer">
        UPDATE BOARD_AAA
        SET LIKES = (SELECT COUNT(*) FROM LIKES_BASs WHERE BNO = #{bno})
        WHERE BOARD_IDX = #{bno}
    </update>

    <select id="likeCheck" resultType="int">
        select count(*) from LIKES_BASs where BNO = #{bno} and USER_ID = #{userId}
    </select>
</mapper>